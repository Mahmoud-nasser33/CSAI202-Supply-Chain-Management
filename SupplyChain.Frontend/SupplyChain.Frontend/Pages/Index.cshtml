@page
@model IndexModel
@{
    ViewData["Title"] = "Dashboard";
}

<div class="container-bento">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h1 class="display-6 fw-bold mb-1">Welcome, <span class="user-name" data-user-name>User</span>!</h1>
            <p class="text-muted">Here's what's happening with your supply chain today</p>
        </div>
        <div>
            <span class="badge bg-primary px-3 py-2 user-role" data-user-role>Administrator</span>
        </div>
    </div>
    <!-- The Bento Grid -->
    <div class="bento-grid">
        
        <!-- 1. AI SCM Brain (Hero Section) - Spans 2 Columns -->
        <div class="card h-100 border-0 shadow-sm glass-panel span-col-2 animate-enter delay-1">
            <div class="card-body position-relative">
                <span class="badge bg-dark text-white border border-secondary rounded-pill mb-3 px-3 shadow-sm">
                    <i class="bi bi-cpu"></i> AI Brain Active
                </span>
                <h3 class="fw-bold mb-3">Insights for <span class="text-primary">Today</span></h3>
                
                <div id="aiInsightsCarousel" class="carousel slide" data-bs-ride="carousel">
                    <div class="carousel-inner">
                        <div class="carousel-item active">
                            <p class="lead text-muted mb-0">
                                <i class="bi bi-lightbulb text-warning me-2"></i> 
                                Suggest increasing stock for <strong>Industrial Steel</strong> by 15% to meet predicted Q4 demand.
                            </p>
                        </div>
                        <div class="carousel-item">
                            <p class="lead text-muted mb-0">
                                <i class="bi bi-exclamation-triangle text-danger me-2"></i> 
                                <strong>Supplier #4</strong> has a 20% higher delay risk this week. Consider alternative sourcing.
                            </p>
                        </div>
                         <div class="carousel-item">
                            <p class="lead text-muted mb-0">
                                <i class="bi bi-graph-up-arrow text-success me-2"></i> 
                                Efficiency up by <strong>4.2%</strong> after recent warehouse optimization.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 2. Revenue KPI (Live Chart) -->
        <div class="card h-100 border-0 shadow-sm glass-panel animate-enter delay-2">
            <div class="card-body d-flex flex-column justify-content-center p-3">
                <div class="d-flex justify-content-between align-items-center mb-2">
                    <div>
                        <span class="text-secondary small fw-bold text-uppercase">Live Revenue</span>
                        <h4 class="fw-bold mb-0" id="liveRevenueDisplay">$1.2M</h4>
                    </div>
                    <i class="bi bi-currency-dollar text-success fs-5"></i>
                </div>
                <div style="height: 100px; width: 100%;">
                    <canvas id="revenueChart"></canvas>
                </div>
                <small class="text-success fw-bold mt-2"><i class="bi bi-arrow-up-short"></i> <span id="revenueGrowth">12%</span> vs last month</small>
            </div>
        </div>

        <!-- 3. Risk KPI -->
        <div class="card h-100 border-0 shadow-sm glass-panel animate-enter delay-2">
            <div class="card-body d-flex flex-column justify-content-center">
                <div class="d-flex justify-content-between mb-2">
                    <span class="text-secondary small fw-bold text-uppercase">Risk Level</span>
                    <i class="bi bi-shield-check text-primary fs-5"></i>
                </div>
                <h2 class="fw-bold mb-0 text-dark">Low</h2>
                <small class="text-muted">94% Confidence Score</small>
            </div>
        </div>

        <!-- 4. Quick Actions (Integrated Tiles) -->
        
        <!-- New Order -->
        <a href="/Orders" class="text-decoration-none animate-enter delay-3">
            <div class="card h-100 border-0 shadow-sm hover-scale text-center py-4 bg-gradient-blue glass-panel" style="background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%) !important;">
                <div class="card-body">
                    <div class="bg-white bg-opacity-25 rounded-circle d-inline-flex p-3 mb-3 text-white">
                        <i class="bi bi-cart-plus fs-3"></i>
                    </div>
                    <h5 class="fw-bold text-white">New Order</h5>
                </div>
            </div>
        </a>

        <!-- Add Product -->
        <a href="/Products" class="text-decoration-none animate-enter delay-3">
            <div class="card h-100 border-0 shadow-sm hover-scale text-center py-4 bg-gradient-primary glass-panel" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%) !important;">
                <div class="card-body">
                    <div class="bg-white bg-opacity-25 rounded-circle d-inline-flex p-3 mb-3 text-white">
                        <i class="bi bi-box-seam fs-3"></i>
                    </div>
                    <h5 class="fw-bold text-white">Add Product</h5>
                </div>
            </div>
        </a>

        <!-- Add Supplier -->
         <a href="/Suppliers" class="text-decoration-none animate-enter delay-4">
            <div class="card h-100 border-0 shadow-sm hover-scale text-center py-4 bg-gradient-purple glass-panel" style="background: linear-gradient(135deg, #8b5cf6 0%, #6d28d9 100%) !important;">
                <div class="card-body">
                    <div class="bg-white bg-opacity-25 rounded-circle d-inline-flex p-3 mb-3 text-white">
                        <i class="bi bi-people fs-3"></i>
                    </div>
                    <h5 class="fw-bold text-white">Add Supplier</h5>
                </div>
            </div>
        </a>

        <!-- Recent Activity (Tall Widget) - Spans 2 Rows -->
        <div class="card border-0 shadow-sm glass-panel span-row-2 animate-enter delay-5">
            <div class="card-header bg-transparent border-bottom-0 pt-0 px-0">
                <h5 class="mb-0 fw-bold"><i class="bi bi-clock-history text-muted"></i> Activity</h5>
            </div>
            <div class="card-body px-0">
                <div class="d-flex mb-4">
                    <div class="flex-shrink-0 me-3">
                        <div class="bg-light p-2 rounded-circle">
                            <i class="bi bi-plus-lg text-success"></i>
                        </div>
                    </div>
                    <div>
                        <p class="mb-1 small fw-bold">Ahmed added item</p>
                        <span class="text-muted small" style="font-size: 0.75rem;">2 mins ago</span>
                    </div>
                </div>
                <div class="d-flex mb-4">
                    <div class="flex-shrink-0 me-3">
                        <div class="bg-light p-2 rounded-circle">
                            <i class="bi bi-cart text-primary"></i>
                        </div>
                    </div>
                    <div>
                        <p class="mb-1 small fw-bold">Order #992 Created</p>
                        <span class="text-muted small" style="font-size: 0.75rem;">1 hour ago</span>
                    </div>
                </div>
                 <div class="d-flex mb-4">
                    <div class="flex-shrink-0 me-3">
                        <div class="bg-light p-2 rounded-circle">
                            <i class="bi bi-person text-secondary"></i>
                        </div>
                    </div>
                    <div>
                        <p class="mb-1 small fw-bold">Admin Login</p>
                        <span class="text-muted small" style="font-size: 0.75rem;">3 hours ago</span>
                    </div>
                </div>
                 <div class="d-flex">
                    <div class="flex-shrink-0 me-3">
                        <div class="bg-light p-2 rounded-circle">
                            <i class="bi bi-truck text-warning"></i>
                        </div>
                    </div>
                    <div>
                        <p class="mb-1 small fw-bold">Shipment Delay</p>
                        <span class="text-muted small" style="font-size: 0.75rem;">5 hours ago</span>
                    </div>
                </div>
            </div>
            <div class="card-footer bg-transparent border-top-0 text-center">
                 <a href="/Notifications" class="text-decoration-none small text-primary fw-bold">View All</a>
            </div>
        </div>

        <!-- Track Shipment -->
        <a href="/Shipments" class="text-decoration-none animate-enter delay-4">
            <div class="card h-100 border-0 shadow-sm hover-scale text-center py-4 bg-gradient-orange glass-panel" style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%) !important;">
                <div class="card-body">
                    <div class="bg-white bg-opacity-25 rounded-circle d-inline-flex p-3 mb-3 text-white">
                        <i class="bi bi-truck fs-3"></i>
                    </div>
                    <h5 class="fw-bold text-white">Track</h5>
                </div>
            </div>
        </a>

        <!-- Add Warehouse -->
        <a href="/CreateWarehouse" class="text-decoration-none animate-enter delay-5">
            <div class="card h-100 border-0 shadow-sm hover-scale text-center py-4 bg-gradient-pink glass-panel" style="background: linear-gradient(135deg, #ec4899 0%, #be185d 100%) !important;">
                <div class="card-body">
                    <div class="bg-white bg-opacity-25 rounded-circle d-inline-flex p-3 mb-3 text-white">
                        <i class="bi bi-building-add fs-3"></i>
                    </div>
                    <h5 class="fw-bold text-white">Warehouse</h5>
                </div>
            </div>
        </a>

        <!-- Add User -->
        <a href="/CreateUser" class="text-decoration-none animate-enter delay-5">
            <div class="card h-100 border-0 shadow-sm hover-scale text-center py-4 bg-gradient-dark glass-panel" style="background: linear-gradient(135deg, #1f2937 0%, #111827 100%) !important;">
                <div class="card-body">
                    <div class="bg-white bg-opacity-25 rounded-circle d-inline-flex p-3 mb-3 text-white">
                        <i class="bi bi-person-plus fs-3"></i>
                    </div>
                    <h5 class="fw-bold text-white">Add User</h5>
                </div>
            </div>
        </a>

        <!-- Attention Needed (Span 3 Cols to fill the bottom nicely next to Activity) -->
        <div class="card border-0 shadow-sm glass-panel span-col-3 animate-enter delay-6">
            <div class="card-header bg-transparent py-3 px-0 border-bottom-0">
                <h5 class="mb-0 fw-bold"><i class="bi bi-exclamation-circle text-danger"></i> Attention Needed</h5>
            </div>
            <div class="card-body p-0">
                <div class="list-group list-group-flush bg-transparent">
                    <a href="/Inventory" class="list-group-item list-group-item-action bg-transparent d-flex justify-content-between align-items-center py-3 px-0 border-bottom">
                        <div class="d-flex align-items-center">
                            <i class="bi bi-box-seam text-warning me-3 fs-5"></i>
                            <div>
                                <h6 class="mb-0 fw-bold text-dark">Low Stock Alert</h6>
                                <small class="text-muted">5 items are below reorder level</small>
                            </div>
                        </div>
                        <span class="badge bg-warning text-dark rounded-pill">Action</span>
                    </a>
                    <a href="/Orders" class="list-group-item list-group-item-action bg-transparent d-flex justify-content-between align-items-center py-3 px-0 border-bottom">
                        <div class="d-flex align-items-center">
                            <i class="bi bi-cart-x text-danger me-3 fs-5"></i>
                            <div>
                                <h6 class="mb-0 fw-bold text-dark">Pending Approvals</h6>
                                <small class="text-muted">3 new purchase orders awaiting review</small>
                            </div>
                        </div>
                        <span class="badge bg-danger rounded-pill">Review</span>
                    </a>
                     <a href="/Shipments" class="list-group-item list-group-item-action bg-transparent d-flex justify-content-between align-items-center py-3 px-0">
                        <div class="d-flex align-items-center">
                            <i class="bi bi-truck text-primary me-3 fs-5"></i>
                            <div>
                                <h6 class="mb-0 fw-bold text-dark">Shipment Delayed</h6>
                                <small class="text-muted">Order #ORD-2025-001 delayed by 2 days</small>
                            </div>
                        </div>
                        <span class="badge bg-primary rounded-pill">Track</span>
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    /* Hover Scale Effect */
    .hover-scale {
        transition: transform 0.2s ease, box-shadow 0.2s ease;
    }
    .hover-scale:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 20px rgba(0,0,0,0.1) !important;
    }
    
    /* Ticker CSS */
    .ticker-wrap {
        position: fixed;
        bottom: 0;
        width: 100%;
        overflow: hidden;
        height: 2.5rem;
        background-color: #333;
        padding-left: 100%;
        box-sizing: content-box;
        z-index: 999;
    }

    .ticker {
        display: inline-block;
        height: 2.5rem;
        line-height: 2.5rem;
        white-space: nowrap;
        padding-right: 100%;
        box-sizing: content-box;
        -webkit-animation-iteration-count: infinite;
        animation-iteration-count: infinite;
        -webkit-animation-timing-function: linear;
        animation-timing-function: linear;
        -webkit-animation-name: ticker;
        animation-name: ticker;
        -webkit-animation-duration: 30s;
        animation-duration: 30s;
    }

    .ticker__item {
        display: inline-block;
        padding: 0 2rem;
        font-size: 0.9rem;
        color: white;
    }

    @@keyframes ticker {
        0% {
            -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0);
            visibility: visible;
        }

        100% {
            -webkit-transform: translate3d(-100%, 0, 0);
            transform: translate3d(-100%, 0, 0);
        }
    }
</style>

<!-- Ticker HTML -->
<div class="ticker-wrap">
    <div class="ticker">
        <div class="ticker__item"><i class="bi bi-activity"></i> Live System: Optimal Performance</div>
        <div class="ticker__item"><i class="bi bi-box-seam"></i> Warehouse A: 85% Capacity</div>
        <div class="ticker__item"><i class="bi bi-truck"></i> Shipment #7732 Out for Delivery</div>
        <div class="ticker__item"><i class="bi bi-currency-dollar"></i> Daily Revenue: $14,230 (Trending Up)</div>
        <div class="ticker__item"><i class="bi bi-cpu"></i> AI Engine: Predictions Updated 2 mins ago</div>
    </div>
</div>